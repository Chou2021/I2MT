2024-01-04,13:53:02 | INFO | Rank 0 | Params:
2024-01-04,13:53:02 | INFO | Rank 0 | C: 3.16
2024-01-04,13:53:02 | INFO | Rank 0 | aggregate: True
2024-01-04,13:53:02 | INFO | Rank 0 | batch_size: 64
2024-01-04,13:53:02 | INFO | Rank 0 | beta1: 0.9
2024-01-04,13:53:02 | INFO | Rank 0 | beta2: 0.98
2024-01-04,13:53:02 | INFO | Rank 0 | checkpoint_path: ./eval/p_coco/lr=0.0005_wd={args.wd}_agg={args.aggregate}_model={args.model}_batchsize={args.batch_size}_workers={args.workers}_date=2024-01-04-13-53-02/checkpoints
2024-01-04,13:53:02 | INFO | Rank 0 | copy_codebase: False
2024-01-04,13:53:02 | INFO | Rank 0 | csv_caption_key: title
2024-01-04,13:53:02 | INFO | Rank 0 | csv_img_key: filepath
2024-01-04,13:53:02 | INFO | Rank 0 | csv_separator: 	
2024-01-04,13:53:02 | INFO | Rank 0 | dataset_type: auto
2024-01-04,13:53:02 | INFO | Rank 0 | dataset_type_val: auto
2024-01-04,13:53:02 | INFO | Rank 0 | debug: False
2024-01-04,13:53:02 | INFO | Rank 0 | demo_out: demo
2024-01-04,13:53:02 | INFO | Rank 0 | dist_backend: nccl
2024-01-04,13:53:02 | INFO | Rank 0 | dist_url: tcp://127.0.0.1:6100
2024-01-04,13:53:02 | INFO | Rank 0 | distributed: False
2024-01-04,13:53:02 | INFO | Rank 0 | dp: False
2024-01-04,13:53:02 | INFO | Rank 0 | droprate: 0.1
2024-01-04,13:53:02 | INFO | Rank 0 | epochs: 32
2024-01-04,13:53:02 | INFO | Rank 0 | eps: 1e-06
2024-01-04,13:53:02 | INFO | Rank 0 | eval_mode: coco
2024-01-04,13:53:02 | INFO | Rank 0 | gpu: 0
2024-01-04,13:53:02 | INFO | Rank 0 | imagenet_v2: None
2024-01-04,13:53:02 | INFO | Rank 0 | imagenet_val: None
2024-01-04,13:53:02 | INFO | Rank 0 | log_level: 20
2024-01-04,13:53:02 | INFO | Rank 0 | log_path: ./eval/p_coco/lr=0.0005_wd={args.wd}_agg={args.aggregate}_model={args.model}_batchsize={args.batch_size}_workers={args.workers}_date=2024-01-04-13-53-02/out.log
2024-01-04,13:53:02 | INFO | Rank 0 | logs: ./eval/p_coco
2024-01-04,13:53:02 | INFO | Rank 0 | lr: 0.0005
2024-01-04,13:53:02 | INFO | Rank 0 | middle_dim: 512
2024-01-04,13:53:02 | INFO | Rank 0 | model: ViT-L/14
2024-01-04,13:53:02 | INFO | Rank 0 | multigpu: None
2024-01-04,13:53:02 | INFO | Rank 0 | n_layer: 2
2024-01-04,13:53:02 | INFO | Rank 0 | name: lr=0.0005_wd={args.wd}_agg={args.aggregate}_model={args.model}_batchsize={args.batch_size}_workers={args.workers}_date=2024-01-04-13-53-02
2024-01-04,13:53:02 | INFO | Rank 0 | ngpus_per_node: 2
2024-01-04,13:53:02 | INFO | Rank 0 | openai_pretrained: True
2024-01-04,13:53:02 | INFO | Rank 0 | precision: amp
2024-01-04,13:53:02 | INFO | Rank 0 | prompts: None
2024-01-04,13:53:02 | INFO | Rank 0 | query_file: None
2024-01-04,13:53:02 | INFO | Rank 0 | rank: 0
2024-01-04,13:53:02 | INFO | Rank 0 | regression_frequency: 2
2024-01-04,13:53:02 | INFO | Rank 0 | report_to: 
2024-01-04,13:53:02 | INFO | Rank 0 | resume: pre-trained/checkpoints/pic2word_model.pt
2024-01-04,13:53:02 | INFO | Rank 0 | retrieval_data: None
2024-01-04,13:53:02 | INFO | Rank 0 | save_frequency: 1
2024-01-04,13:53:02 | INFO | Rank 0 | save_most_recent: False
2024-01-04,13:53:02 | INFO | Rank 0 | skip_aggregate: False
2024-01-04,13:53:02 | INFO | Rank 0 | skip_scheduler: False
2024-01-04,13:53:02 | INFO | Rank 0 | source_data: None
2024-01-04,13:53:02 | INFO | Rank 0 | target_data: None
2024-01-04,13:53:02 | INFO | Rank 0 | target_pad: False
2024-01-04,13:53:02 | INFO | Rank 0 | tensorboard: False
2024-01-04,13:53:02 | INFO | Rank 0 | tensorboard_path: 
2024-01-04,13:53:02 | INFO | Rank 0 | time_suffix: True
2024-01-04,13:53:02 | INFO | Rank 0 | train_data: None
2024-01-04,13:53:02 | INFO | Rank 0 | use_bn_sync: False
2024-01-04,13:53:02 | INFO | Rank 0 | use_debiased_sampler: False
2024-01-04,13:53:02 | INFO | Rank 0 | use_prefix: False
2024-01-04,13:53:02 | INFO | Rank 0 | val_data: None
2024-01-04,13:53:02 | INFO | Rank 0 | wandb: False
2024-01-04,13:53:02 | INFO | Rank 0 | wandb_notes: 
2024-01-04,13:53:02 | INFO | Rank 0 | warmup: 10000
2024-01-04,13:53:02 | INFO | Rank 0 | wd: 0.2
2024-01-04,13:53:02 | INFO | Rank 0 | workers: 1
2024-01-04,13:53:02 | INFO | Rank 0 | world_size: 1
2024-01-04,13:53:02 | INFO | Rank 0 | zeroshot_frequency: 2
2024-01-04,13:53:02 | INFO | Rank 0 | Use GPU: 0 for training
2024-01-04,13:53:15 | INFO | Rank 0 | => loaded checkpoint 'pre-trained/checkpoints/pic2word_model.pt' (epoch 30)
2024-01-04,14:01:20 | INFO | Rank 0 | Eval composed Feature
image_to_ref_mean_rank: 73.1301	
image_to_ref_median_rank: 17.0000	
image_to_ref_R@1: 0.1692	
image_to_ref_R@5: 0.3341	
image_to_ref_R@10: 0.4199	
image_to_ref_R@50: 0.7410	
image_to_ref_R@100: 0.8737	
ref_to_image_mean_rank: 122.5660	
ref_to_image_median_rank: 28.0000	
ref_to_image_R@1: 0.1062	
ref_to_image_R@5: 0.2388	
ref_to_image_R@10: 0.3255	
ref_to_image_R@50: 0.6201	
ref_to_image_R@100: 0.7681

2024-01-04,14:01:24 | INFO | Rank 0 | 
Eval image Feature
image_to_ref_mean_rank: 1086.1662	image_to_ref_median_rank: 384.0000	image_to_ref_R@1: 0.1268	image_to_ref_R@5: 0.2034	image_to_ref_R@10: 0.2476	image_to_ref_R@50: 0.3587	image_to_ref_R@100: 0.4031	ref_to_image_mean_rank: 1284.4319	ref_to_image_median_rank: 556.0000	ref_to_image_R@1: 0.0898	ref_to_image_R@5: 0.1561	ref_to_image_R@10: 0.1987	ref_to_image_R@50: 0.3020	ref_to_image_R@100: 0.3547
2024-01-04,14:01:27 | INFO | Rank 0 | Eval text Featureimage_to_ref_mean_rank: 83.4940	image_to_ref_median_rank: 27.0000	image_to_ref_R@1: 0.0760	image_to_ref_R@5: 0.2042	image_to_ref_R@10: 0.2959	image_to_ref_R@50: 0.6697	image_to_ref_R@100: 0.8481	ref_to_image_mean_rank: 128.6371	ref_to_image_median_rank: 39.0000	ref_to_image_R@1: 0.0594	ref_to_image_R@5: 0.1563	ref_to_image_R@10: 0.2348	ref_to_image_R@50: 0.5692	ref_to_image_R@100: 0.7599
2024-01-04,14:01:31 | INFO | Rank 0 | Eval mixture Featureimage_to_ref_mean_rank: 154.9595	image_to_ref_median_rank: 41.0000	image_to_ref_R@1: 0.1622	image_to_ref_R@5: 0.2613	image_to_ref_R@10: 0.3158	image_to_ref_R@50: 0.5414	image_to_ref_R@100: 0.6852	ref_to_image_mean_rank: 492.2006	ref_to_image_median_rank: 62.0000	ref_to_image_R@1: 0.1079	ref_to_image_R@5: 0.2050	ref_to_image_R@10: 0.2735	ref_to_image_R@50: 0.4676	ref_to_image_R@100: 0.5622

/opt/conda/lib/python3.10/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.24.3
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
2024-01-05,04:31:00 | INFO | Rank 0 | Params:
2024-01-05,04:31:00 | INFO | Rank 0 | C: 3.16
2024-01-05,04:31:00 | INFO | Rank 0 | aggregate: True
2024-01-05,04:31:00 | INFO | Rank 0 | batch_size: 64
2024-01-05,04:31:00 | INFO | Rank 0 | beta1: 0.9
2024-01-05,04:31:00 | INFO | Rank 0 | beta2: 0.98
2024-01-05,04:31:00 | INFO | Rank 0 | checkpoint_path: ./eval/p_imgnet/lr=0.0005_wd={args.wd}_agg={args.aggregate}_model={args.model}_batchsize={args.batch_size}_workers={args.workers}_date=2024-01-05-04-31-00/checkpoints
2024-01-05,04:31:00 | INFO | Rank 0 | copy_codebase: False
2024-01-05,04:31:00 | INFO | Rank 0 | csv_caption_key: title
2024-01-05,04:31:00 | INFO | Rank 0 | csv_img_key: filepath
2024-01-05,04:31:00 | INFO | Rank 0 | csv_separator: 	
2024-01-05,04:31:00 | INFO | Rank 0 | dataset_type: auto
2024-01-05,04:31:00 | INFO | Rank 0 | dataset_type_val: auto
2024-01-05,04:31:00 | INFO | Rank 0 | debug: False
2024-01-05,04:31:00 | INFO | Rank 0 | demo_out: demo
2024-01-05,04:31:00 | INFO | Rank 0 | dist_backend: nccl
2024-01-05,04:31:00 | INFO | Rank 0 | dist_url: tcp://127.0.0.1:6100
2024-01-05,04:31:00 | INFO | Rank 0 | distributed: False
2024-01-05,04:31:00 | INFO | Rank 0 | dp: False
2024-01-05,04:31:00 | INFO | Rank 0 | droprate: 0.1
2024-01-05,04:31:00 | INFO | Rank 0 | epochs: 32
2024-01-05,04:31:00 | INFO | Rank 0 | eps: 1e-06
2024-01-05,04:31:00 | INFO | Rank 0 | eval_mode: imgnet
2024-01-05,04:31:00 | INFO | Rank 0 | gpu: 0
2024-01-05,04:31:00 | INFO | Rank 0 | imagenet_v2: None
2024-01-05,04:31:00 | INFO | Rank 0 | imagenet_val: None
2024-01-05,04:31:00 | INFO | Rank 0 | log_level: 20
2024-01-05,04:31:00 | INFO | Rank 0 | log_path: ./eval/p_imgnet/lr=0.0005_wd={args.wd}_agg={args.aggregate}_model={args.model}_batchsize={args.batch_size}_workers={args.workers}_date=2024-01-05-04-31-00/out.log
2024-01-05,04:31:00 | INFO | Rank 0 | logs: ./eval/p_imgnet
2024-01-05,04:31:00 | INFO | Rank 0 | lr: 0.0005
2024-01-05,04:31:00 | INFO | Rank 0 | middle_dim: 512
2024-01-05,04:31:00 | INFO | Rank 0 | model: ViT-L/14
2024-01-05,04:31:00 | INFO | Rank 0 | multigpu: None
2024-01-05,04:31:00 | INFO | Rank 0 | n_layer: 2
2024-01-05,04:31:00 | INFO | Rank 0 | name: lr=0.0005_wd={args.wd}_agg={args.aggregate}_model={args.model}_batchsize={args.batch_size}_workers={args.workers}_date=2024-01-05-04-31-00
2024-01-05,04:31:00 | INFO | Rank 0 | ngpus_per_node: 2
2024-01-05,04:31:00 | INFO | Rank 0 | openai_pretrained: True
2024-01-05,04:31:00 | INFO | Rank 0 | precision: amp
2024-01-05,04:31:00 | INFO | Rank 0 | prompts: None
2024-01-05,04:31:00 | INFO | Rank 0 | query_file: None
2024-01-05,04:31:00 | INFO | Rank 0 | rank: 0
2024-01-05,04:31:00 | INFO | Rank 0 | regression_frequency: 2
2024-01-05,04:31:00 | INFO | Rank 0 | report_to: 
2024-01-05,04:31:00 | INFO | Rank 0 | resume: pic2word_model.pt
2024-01-05,04:31:00 | INFO | Rank 0 | retrieval_data: None
2024-01-05,04:31:00 | INFO | Rank 0 | save_frequency: 1
2024-01-05,04:31:00 | INFO | Rank 0 | save_most_recent: False
2024-01-05,04:31:00 | INFO | Rank 0 | skip_aggregate: False
2024-01-05,04:31:00 | INFO | Rank 0 | skip_scheduler: False
2024-01-05,04:31:00 | INFO | Rank 0 | source_data: None
2024-01-05,04:31:00 | INFO | Rank 0 | target_data: None
2024-01-05,04:31:00 | INFO | Rank 0 | target_pad: False
2024-01-05,04:31:00 | INFO | Rank 0 | tensorboard: False
2024-01-05,04:31:00 | INFO | Rank 0 | tensorboard_path: 
2024-01-05,04:31:00 | INFO | Rank 0 | time_suffix: True
2024-01-05,04:31:00 | INFO | Rank 0 | train_data: None
2024-01-05,04:31:00 | INFO | Rank 0 | use_bn_sync: False
2024-01-05,04:31:00 | INFO | Rank 0 | use_debiased_sampler: False
2024-01-05,04:31:00 | INFO | Rank 0 | use_prefix: False
2024-01-05,04:31:00 | INFO | Rank 0 | val_data: None
2024-01-05,04:31:00 | INFO | Rank 0 | wandb: False
2024-01-05,04:31:00 | INFO | Rank 0 | wandb_notes: 
2024-01-05,04:31:00 | INFO | Rank 0 | warmup: 10000
2024-01-05,04:31:00 | INFO | Rank 0 | wd: 0.2
2024-01-05,04:31:00 | INFO | Rank 0 | workers: 1
2024-01-05,04:31:00 | INFO | Rank 0 | world_size: 1
2024-01-05,04:31:00 | INFO | Rank 0 | zeroshot_frequency: 2
2024-01-05,04:31:00 | INFO | Rank 0 | Use GPU: 0 for training
100%|████████████████████████████████████████| 933M/933M [00:08<00:00, 108MiB/s]
2024-01-05,04:31:19 | INFO | Rank 0 | => loaded checkpoint 'pic2word_model.pt' (epoch 30)
  0%|                                                   | 0/266 [00:00<?, ?it/s]/opt/conda/lib/python3.10/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.24.3
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
100%|█████████████████████████████████████████| 266/266 [13:34<00:00,  3.06s/it]
  0%|                                                   | 0/157 [00:00<?, ?it/s]/opt/conda/lib/python3.10/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.24.3
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
100%|█████████████████████████████████████████| 157/157 [08:53<00:00,  3.40s/it]
2024-01-05,04:53:56 | INFO | Rank 0 | 
Eval composed Feature
Real2Sketch_R@1: 0.0124	Real2Sketch_P@1: 0.2570	
Real2Sketch_R@5: 0.0530	Real2Sketch_P@5: 0.2300	
Real2Sketch_R@10: 0.0880	Real2Sketch_P@10: 0.1962	
Real2Sketch_R@50: 0.2101	Real2Sketch_P@50: 0.0995	
Real2Sketch_R@100: 0.2766	Real2Sketch_P@100: 0.0665	
Real2Sketch_R@200: 0.3542	Real2Sketch_P@200: 0.0428

2024-01-05,04:54:05 | INFO | Rank 0 | 
Eval image Feature
Real2Sketch_R@1: 0.0000	Real2Sketch_P@1: 0.0000	
Real2Sketch_R@5: 0.0010	Real2Sketch_P@5: 0.0048	
Real2Sketch_R@10: 0.0031	Real2Sketch_P@10: 0.0069	
Real2Sketch_R@50: 0.0449	Real2Sketch_P@50: 0.0202	
Real2Sketch_R@100: 0.1017	Real2Sketch_P@100: 0.0228	
Real2Sketch_R@200: 0.1639	Real2Sketch_P@200: 0.0189

2024-01-05,04:54:14 | INFO | Rank 0 | 
Eval text Feature
Real2Sketch_R@1: 0.0001	Real2Sketch_P@1: 0.0050	
Real2Sketch_R@5: 0.0008	Real2Sketch_P@5: 0.0050	
Real2Sketch_R@10: 0.0018	Real2Sketch_P@10: 0.0050	
Real2Sketch_R@50: 0.0106	Real2Sketch_P@50: 0.0050	
Real2Sketch_R@100: 0.0224	Real2Sketch_P@100: 0.0050	
Real2Sketch_R@200: 0.0434	Real2Sketch_P@200: 0.0050

2024-01-05,04:54:23 | INFO | Rank 0 | 
Eval mixture Feature
Real2Sketch_R@1: 0.0000	Real2Sketch_P@1: 0.0000	
Real2Sketch_R@5: 0.0091	Real2Sketch_P@5: 0.0393	
Real2Sketch_R@10: 0.0218	Real2Sketch_P@10: 0.0484	
Real2Sketch_R@50: 0.1332	Real2Sketch_P@50: 0.0628	
Real2Sketch_R@100: 0.2196	Real2Sketch_P@100: 0.0524	
Real2Sketch_R@200: 0.3015	Real2Sketch_P@200: 0.0363

  0%|                                                   | 0/157 [00:00<?, ?it/s]/opt/conda/lib/python3.10/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.24.3
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
100%|█████████████████████████████████████████| 157/157 [08:54<00:00,  3.40s/it]
2024-01-05,05:03:27 | INFO | Rank 0 | 
Eval composed Feature
Real2Sketch_R@1: 0.0120	Real2Sketch_P@1: 0.0667	
Real2Sketch_R@5: 0.0795	Real2Sketch_P@5: 0.0814	
Real2Sketch_R@10: 0.1271	Real2Sketch_P@10: 0.0671	
Real2Sketch_R@50: 0.2464	Real2Sketch_P@50: 0.0283	
Real2Sketch_R@100: 0.3039	Real2Sketch_P@100: 0.0174	
Real2Sketch_R@200: 0.3656	Real2Sketch_P@200: 0.0102

2024-01-05,05:03:36 | INFO | Rank 0 | 
Eval image Feature
Real2Sketch_R@1: 0.0000	Real2Sketch_P@1: 0.0000	
Real2Sketch_R@5: 0.0011	Real2Sketch_P@5: 0.0008	
Real2Sketch_R@10: 0.0022	Real2Sketch_P@10: 0.0009	
Real2Sketch_R@50: 0.0175	Real2Sketch_P@50: 0.0013	
Real2Sketch_R@100: 0.0368	Real2Sketch_P@100: 0.0016	
Real2Sketch_R@200: 0.0676	Real2Sketch_P@200: 0.0016

2024-01-05,05:03:45 | INFO | Rank 0 | 
Eval text Feature
Real2Sketch_R@1: 0.0025	Real2Sketch_P@1: 0.0050	
Real2Sketch_R@5: 0.0057	Real2Sketch_P@5: 0.0050	
Real2Sketch_R@10: 0.0084	Real2Sketch_P@10: 0.0050	
Real2Sketch_R@50: 0.0374	Real2Sketch_P@50: 0.0049	
Real2Sketch_R@100: 0.0641	Real2Sketch_P@100: 0.0049	
Real2Sketch_R@200: 0.1411	Real2Sketch_P@200: 0.0049

2024-01-05,05:03:54 | INFO | Rank 0 | 
Eval mixture Feature
Real2Sketch_R@1: 0.0000	Real2Sketch_P@1: 0.0000	
Real2Sketch_R@5: 0.0102	Real2Sketch_P@5: 0.0078	
Real2Sketch_R@10: 0.0203	Real2Sketch_P@10: 0.0086	
Real2Sketch_R@50: 0.1027	Real2Sketch_P@50: 0.0102	
Real2Sketch_R@100: 0.1755	Real2Sketch_P@100: 0.0094	
Real2Sketch_R@200: 0.2465	Real2Sketch_P@200: 0.0068

  0%|                                                   | 0/157 [00:00<?, ?it/s]/opt/conda/lib/python3.10/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.24.3
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
100%|█████████████████████████████████████████| 157/157 [08:53<00:00,  3.40s/it]
2024-01-05,05:12:57 | INFO | Rank 0 | 
Eval composed Feature
Real2Sketch_R@1: 0.0073	Real2Sketch_P@1: 0.0661	
Real2Sketch_R@5: 0.0526	Real2Sketch_P@5: 0.0977	
Real2Sketch_R@10: 0.0876	Real2Sketch_P@10: 0.0878	
Real2Sketch_R@50: 0.2144	Real2Sketch_P@50: 0.0484	
Real2Sketch_R@100: 0.2874	Real2Sketch_P@100: 0.0332	
Real2Sketch_R@200: 0.3684	Real2Sketch_P@200: 0.0213

2024-01-05,05:13:06 | INFO | Rank 0 | 
Eval image Feature
Real2Sketch_R@1: 0.0000	Real2Sketch_P@1: 0.0000	
Real2Sketch_R@5: 0.0021	Real2Sketch_P@5: 0.0032	
Real2Sketch_R@10: 0.0055	Real2Sketch_P@10: 0.0043	
Real2Sketch_R@50: 0.0565	Real2Sketch_P@50: 0.0107	
Real2Sketch_R@100: 0.1109	Real2Sketch_P@100: 0.0122	
Real2Sketch_R@200: 0.1728	Real2Sketch_P@200: 0.0097

2024-01-05,05:13:15 | INFO | Rank 0 | 
Eval text Feature
Real2Sketch_R@1: 0.0003	Real2Sketch_P@1: 0.0050	
Real2Sketch_R@5: 0.0068	Real2Sketch_P@5: 0.0050	
Real2Sketch_R@10: 0.0078	Real2Sketch_P@10: 0.0050	
Real2Sketch_R@50: 0.0238	Real2Sketch_P@50: 0.0043	
Real2Sketch_R@100: 0.0384	Real2Sketch_P@100: 0.0041	
Real2Sketch_R@200: 0.0640	Real2Sketch_P@200: 0.0037

2024-01-05,05:13:24 | INFO | Rank 0 | 
Eval mixture Feature
Real2Sketch_R@1: 0.0000	Real2Sketch_P@1: 0.0000	
Real2Sketch_R@5: 0.0047	Real2Sketch_P@5: 0.0084	
Real2Sketch_R@10: 0.0117	Real2Sketch_P@10: 0.0103	
Real2Sketch_R@50: 0.0970	Real2Sketch_P@50: 0.0200	
Real2Sketch_R@100: 0.1751	Real2Sketch_P@100: 0.0198	
Real2Sketch_R@200: 0.2605	Real2Sketch_P@200: 0.0148

  0%|                                                   | 0/157 [00:00<?, ?it/s]/opt/conda/lib/python3.10/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.24.3
  warnings.warn(f"A NumPy version >={np_minversion} and <{np_maxversion}"
100%|█████████████████████████████████████████| 157/157 [08:53<00:00,  3.40s/it]
2024-01-05,05:22:27 | INFO | Rank 0 | 

Eval composed Feature
Real2Sketch_R@1: 0.0188	Real2Sketch_P@1: 0.1395	
Real2Sketch_R@5: 0.0679	Real2Sketch_P@5: 0.1088	
Real2Sketch_R@10: 0.1004	Real2Sketch_P@10: 0.0860	
Real2Sketch_R@50: 0.2169	Real2Sketch_P@50: 0.0413	
Real2Sketch_R@100: 0.2854	Real2Sketch_P@100: 0.0275	
Real2Sketch_R@200: 0.3703	Real2Sketch_P@200: 0.0175

2024-01-05,05:22:36 | INFO | Rank 0 | 
Eval image Feature
Real2Sketch_R@1: 0.0000	Real2Sketch_P@1: 0.0000	
Real2Sketch_R@5: 0.0017	Real2Sketch_P@5: 0.0026	
Real2Sketch_R@10: 0.0033	Real2Sketch_P@10: 0.0027	
Real2Sketch_R@50: 0.0404	Real2Sketch_P@50: 0.0064	
Real2Sketch_R@100: 0.0922	Real2Sketch_P@100: 0.0073	
Real2Sketch_R@200: 0.1553	Real2Sketch_P@200: 0.0062

2024-01-05,05:22:45 | INFO | Rank 0 | 
Eval text Feature
Real2Sketch_R@1: 0.0001	Real2Sketch_P@1: 0.0050	
Real2Sketch_R@5: 0.0017	Real2Sketch_P@5: 0.0050	
Real2Sketch_R@10: 0.0035	Real2Sketch_P@10: 0.0050	
Real2Sketch_R@50: 0.0202	Real2Sketch_P@50: 0.0049	
Real2Sketch_R@100: 0.0440	Real2Sketch_P@100: 0.0047	
Real2Sketch_R@200: 0.0899	Real2Sketch_P@200: 0.0046

2024-01-05,05:22:54 | INFO | Rank 0 | 
Eval mixture Feature
Real2Sketch_R@1: 0.0000	Real2Sketch_P@1: 0.0000	
Real2Sketch_R@5: 0.0063	Real2Sketch_P@5: 0.0113	
Real2Sketch_R@10: 0.0156	Real2Sketch_P@10: 0.0136	
Real2Sketch_R@50: 0.1156	Real2Sketch_P@50: 0.0198	
Real2Sketch_R@100: 0.2021	Real2Sketch_P@100: 0.0180	
Real2Sketch_R@200: 0.2895	Real2Sketch_P@200: 0.0129
evaluation done
